var click,start,protocol=window.location.protocol,domain=window.location.origin.replace(protocol,"");$("img.thumb").click(function(){var e=$(this)[0].src;$(".preview").html('<img src="'+e+'" width="100%">')}),$("#manager-sort").click(function(){if($(".fa-sort").length>0?(sort="asc",$("#manager-sort i").removeClass("fa-sort").addClass("fa-sort-alpha-asc")):$(".fa-sort-alpha-asc").length>0?(sort="desc",$("#manager-sort i").removeClass("fa-sort-alpha-asc").addClass("fa-sort-alpha-desc")):$(".fa-sort-alpha-desc").length>0&&(sort="asc",$("#manager-sort i").removeClass("fa-sort-alpha-desc").addClass("fa-sort-alpha-asc")),!sort&&!click)return!1;var e=$("#manager_keyword").val();$("#manager_search_load").hide(),start_manager=10,click=!0,new _request({method:"POST",dataType:"json",data:"type=manager_sort&name="+sort+"&keyword="+e,onComplete:function(e){if(e.status)$(".manager nav").hide(),$("#manager_sort_load").show(),$(".manager_response").html(e.msg);else{$(".msg-danger").show(),$(".msg-danger span").html(e.msg);var a=setInterval(function(){clearInterval(a),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}})}),$(function(){var e=$("#manager_sort_load");start_manager=10,text_manager=e.text(),e.click(function(){manager_keyword=$("#manager_keyword"),$(this).hasClass("clicked")||($(this).addClass("clicked").text("Loading..."),go_to=$(".manager_response tr:last").offset().top,new _request({method:"POST",dataType:"json",data:"type=manager_sort&name="+sort+"&keyword="+manager_keyword.val()+"&start="+start_manager,onComplete:function(a){if(a.status)$(".manager_response").append(a.msg),$("html, body").animate({scrollTop:go_to},800),start_manager+=10;else{$(".msg-danger").show(),$(".msg-danger span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3);manager_keyword.val(""),e.hide()}e.removeClass("clicked").text(text_manager)}}))})});var manager_search=function(){var e=$("#manager_keyword").val();if(!e||e.length<3||click)return!1;$("#manager_sort_load").hide(),click=!0,start=10;var a="type=manager_search&keyword="+e;new _request({method:"POST",dataType:"json",data:a,onComplete:function(e){if(e.status)$(".manager nav").hide(),$("#manager_search_load").show(),$(".manager_response").html(e.msg);else{$(".msg-danger").show(),$(".msg-danger span").html(e.msg);var a=setInterval(function(){clearInterval(a),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}})};$(function(){var e=$("#manager_search_load");start=10,text_default=e.text(),e.click(function(){if(manager_keyword=$("#manager_keyword"),!manager_keyword)return!1;if(!$(this).hasClass("clicked")){$(this).addClass("clicked").text("Loading..."),go_to=$(".manager_response tr:last").offset().top;var a="type=manager_search&keyword="+manager_keyword.val()+"&start="+start;new _request({method:"POST",dataType:"json",data:a,onComplete:function(a){if(a.status)$(".manager_response").append(a.msg),$("html, body").animate({scrollTop:go_to},800),start+=10;else{$(".msg-danger").show(),$(".msg-danger span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3);manager_keyword.val(""),e.hide()}e.removeClass("clicked").text(text_default)}})}})});var manager_info=function(e){if(!e||click)return!1;click=!0;var a="type=manager_info&id="+e;new _request({method:"POST",dataType:"json",data:a,onComplete:function(e){if(e.status&&e.manager[0])$("#manager_info_embed").val(""),$("#manager_info_title").text(e.manager[0].name),$("#manager_info_id").val(e.manager[0].id),$("#manager_info_filename").val(e.manager[0].name),$("#manager_info_password").val(e.manager[0].pass),$("#manager_info_share").val(protocol+domain+"/file/"+e.manager[0].slug),$("#manager_info_embed, .manager_info_embed, #manager_info_subscene, .manager_info_subscene").hide(),1==e.manager[0].type&&($("#manager_info_embed, .manager_info_embed, #manager_info_subscene, .manager_info_subscene").show(),$("#manager_info_subscene").val(e.manager[0].track),$("#manager_info_embed").val("<iframe src='"+domain+"/embed/"+e.manager[0].slug+"' width='640' height='360' frameborder='0' allowfullscreen></iframe>")),2==e.manager[0].type&&($("#manager_info_embed, .manager_info_embed").show(),$("#manager_info_subscene, .manager_info_subscene").hide(),$("#manager_info_embed").val(protocol+domain+"/image/"+e.manager[0].slug));else{$(".msg-danger").show(),$(".msg-danger span").html(e.msg),$("#manager_info_title").html(e.msg),$("#manager_info_filename, #manager_info_password, #manager_info_share, #manager_info_embed").val("");var a=setInterval(function(){clearInterval(a),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}})},active_file=function(e){if(!e||click)return!1;if(confirm("Bạn muốn Active file này?")){click=!0;var a="type=active_file&id="+e;new _request({method:"POST",dataType:"json",data:a,onComplete:function(a){if(a.status){$("#manager-"+e).remove(),$(".msg-success").show(),$(".msg-success span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-success span").html(""),$(".msg-success").hide()},3e3)}else{$(".msg-danger").show(),$(".msg-danger span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}})}},block_file=function(e){if(!e||click)return!1;if(confirm("Bạn có chắc muốn Block file này?")){click=!0;var a="type=block_file&id="+e;new _request({method:"POST",dataType:"json",data:a,onComplete:function(a){if(a.status){$("#manager-"+e).remove(),$(".msg-success").show(),$(".msg-success span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-success span").html(""),$(".msg-success").hide()},3e3)}else{$(".msg-danger").show(),$(".msg-danger span").html(a.msg);var n=setInterval(function(){clearInterval(n),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}})}},join_group=function(){return click?!1:(click=!0,void new _request({method:"POST",dataType:"json",data:"type=join_group",onComplete:function(e){if(e.status){$("#join-group").remove(),$(".msg-success").show(),$(".msg-success span").html(e.msg);var a=setInterval(function(){clearInterval(a),$(".msg-success span").html(""),$(".msg-success").hide()},3e3)}else{$(".msg-danger").show(),$(".msg-danger span").html(e.msg);var a=setInterval(function(){clearInterval(a),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3)}}}))},copyToClipboard=function(e){var a,n,t="INPUT"===e.tagName||"TEXTAREA"===e.tagName;t&&(target=e,a=e.selectionStart,n=e.selectionEnd);var s=document.activeElement;target.focus(),target.setSelectionRange(0,target.value.length);var r;try{r=document.execCommand("copy")}catch(o){r=!1}return s&&"function"==typeof s.focus&&s.focus(),t?e.setSelectionRange(a,n):target.textContent="",r},_request=function(e){var a=function(){},n=$('meta[name="csrf-token"]').attr("content");return n?(this.onComplete=e.onComplete||a,this.onError=e.onError||a,this.method=e.method,this.url=e.url||"",this.headers={"X-CSRF-TOKEN":n},this.dataType=e.dataType||"",this.data=e.data||"",void this._send()):!1};_request.prototype._send=function(){var e=this;$(".loading").show(),$(".loading").html('<img src="../../imgs/radio.gif">'),$.ajax({type:e.method,url:e.url,headers:e.headers,dataType:e.dataType,data:e.data,success:function(a){e.onComplete(a),$(".loading").hide(),click=!1},error:function(a){$(".loading").hide(),$(".msg-danger").show(),$(".msg-danger span").html("Có lỗi xảy ra, vui lòng thử lại");var n=setInterval(function(){clearInterval(n),$(".msg-danger span").html(""),$(".msg-danger").hide()},3e3);e.onError(a),click=!1}})};